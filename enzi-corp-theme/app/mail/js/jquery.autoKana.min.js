!function(n){n.fn.autoKana=function(t,e,a){function r(){var n,t;if(""==(n=c.val()))o(),l();else{if(n=function(n){{if(n.match(s))return n.replace(s,"");var t,e,a;for(e=s.split(""),a=n.split(""),t=0;t<e.length;t++)e[t]==a[t]&&(a[t]="");return a.join("")}}(n),g==n)return;g=n,m||(function(n){if(!m)if(Math.abs(v.length-n.length)>1){var t=n.join("").replace(d,"").split("");Math.abs(v.length-t.length)>1&&u()}else v.length==g.length&&v.join("")!=g&&g.match(k)&&u()}(t=n.replace(k,"").split("")),l(t))}}function i(n){return n>=12353&&n<=12435||12445==n||12446==n}function l(n){if(!m&&(n&&(v=n),w)){var t=function(n){{if(j.katakana){var t,e,a;for(a=new String,e=0;e<n.length;e++)i(t=n.charCodeAt(e))?a+=String.fromCharCode(t+96):a+=n.charAt(e);return a}return n}}(p+v.join(""));h.val(t)}}function o(){p="",m=!1,s="",g="",v=[]}function f(){p=h.val(),m=!1,s=c.val()}function u(){p+=v.join(""),m=!0,v=[]}var c,h,g,v,s,p,j=n.extend({katakana:!1},a),k=new RegExp("[^ 　ぁあ-んー]","g"),d=new RegExp("[ぁぃぅぇぉっゃゅょ]","g"),w=!1,b=null,m=!0;c=n(t),h=n(e),w=!0,o(),c.blur(function(n){clearInterval(b)}),c.focus(function(n){f(),b=setInterval(r,30)}),c.keydown(function(n){m&&f()})}}(jQuery);